# LLMæ¨¡å—æ¶æ„è®¾è®¡è§„èŒƒ

> **çŠ¶æ€**: ğŸ“ éœ€æ±‚å®šä¹‰é˜¶æ®µ  
> **ä¼˜å…ˆçº§**: â­â­â­â­â­ æ ¸å¿ƒæ¨¡å—  
> **é¢„è®¡å·¥æœŸ**: 4-6å‘¨

---

## ğŸ“‹ ç›®æ ‡æ¦‚è¿°

è®¾è®¡å¹¶å®ç°daoyoucodeçš„æ ¸å¿ƒLLMæ¨¡å—ï¼Œèåˆä»¥ä¸‹å››ä¸ªæ¥æºçš„æœ€ä½³å®è·µï¼š

1. **ç°æœ‰aiæ¨¡å—** (`D:\daoyouspace\daoyoucode\ai`) - Skillæ’å…¥æ¨¡å¼ã€è®°å¿†åŠŸèƒ½ã€ä¸Šä¸‹æ–‡æ£€ç´¢
2. **daoyouCodePilot** - ä¸­æ–‡ä¼˜åŒ–ã€å›½äº§LLMæ·±åº¦é›†æˆ
3. **oh-my-opencode** - å¤šæ™ºèƒ½ä½“ç¼–æ’ã€Hookç³»ç»Ÿ
4. **OpenCode** - æ¨¡å‹æ— å…³æ¶æ„ã€æ’ä»¶ç³»ç»Ÿ

---

## ğŸ¯ æ ¸å¿ƒéœ€æ±‚

### 1. æ¶æ„è®¾è®¡åŸåˆ™

#### 1.1 æ¨¡å—åŒ–è®¾è®¡
- [ ] LLMå±‚ç‹¬ç«‹äºä¸šåŠ¡é€»è¾‘
- [ ] æ”¯æŒå¤šç§LLMæä¾›å•†ï¼ˆé€šä¹‰åƒé—®ã€DeepSeekã€Claudeã€GPTã€æœ¬åœ°æ¨¡å‹ï¼‰
- [ ] ç»Ÿä¸€çš„æ¥å£æŠ½è±¡
- [ ] æ’ä»¶åŒ–æ‰©å±•æœºåˆ¶

#### 1.2 æ€§èƒ½ä¼˜åŒ–
- [ ] è¿æ¥æ± ç®¡ç†ï¼ˆå€Ÿé‰´ç°æœ‰aiæ¨¡å—çš„LLMClientPoolï¼‰
- [ ] æ™ºèƒ½ç¼“å­˜ç­–ç•¥
- [ ] å¹¶å‘æ§åˆ¶å’Œé™æµ
- [ ] Tokenä½¿ç”¨ä¼˜åŒ–

#### 1.3 æˆæœ¬æ§åˆ¶
- [ ] æ™ºèƒ½æ¨¡å‹é€‰æ‹©ï¼ˆæ ¹æ®ä»»åŠ¡å¤æ‚åº¦ï¼‰
- [ ] Tokenç»Ÿè®¡å’Œé¢„ç®—æ§åˆ¶
- [ ] ä¸Šä¸‹æ–‡å‹ç¼©å’Œæˆªæ–­
- [ ] æˆæœ¬æŠ¥å‘Šå’Œåˆ†æ

---

### 2. æ ¸å¿ƒåŠŸèƒ½éœ€æ±‚

#### 2.1 LLMå®¢æˆ·ç«¯å±‚

**éœ€æ±‚æ¥æº**: ç°æœ‰aiæ¨¡å— + OpenCode

**åŠŸèƒ½ç‚¹**:
- [ ] ç»Ÿä¸€çš„LLMå®¢æˆ·ç«¯æ¥å£ï¼ˆOpenAIå…¼å®¹æ ¼å¼ï¼‰
- [ ] æ”¯æŒåŒæ­¥å’Œå¼‚æ­¥è°ƒç”¨
- [ ] æ”¯æŒæµå¼å“åº”ï¼ˆSSEï¼‰
- [ ] è‡ªåŠ¨é‡è¯•å’Œé”™è¯¯å¤„ç†
- [ ] è¯·æ±‚/å“åº”æ—¥å¿—è®°å½•

**æŠ€æœ¯å®ç°**:
```python
class BaseLLMClient(ABC):
    @abstractmethod
    async def chat(self, prompt: str, **kwargs) -> str:
        """åŒæ­¥å¯¹è¯"""
        pass
    
    @abstractmethod
    async def stream_chat(self, prompt: str, **kwargs):
        """æµå¼å¯¹è¯"""
        pass
```

**æ”¯æŒçš„LLMæä¾›å•†**:
- é€šä¹‰åƒé—®ç³»åˆ—ï¼ˆqwen-max, qwen-plus, qwen-turbo, qwen-coder-plusï¼‰
- DeepSeekç³»åˆ—ï¼ˆdeepseek-chat, deepseek-coderï¼‰
- Claudeç³»åˆ—ï¼ˆclaude-opus-4-5, claude-sonnet-4-5, claude-haiku-4-5ï¼‰
- GPTç³»åˆ—ï¼ˆgpt-5.2, gpt-4oï¼‰
- Geminiç³»åˆ—ï¼ˆgemini-3-pro, gemini-3-flashï¼‰
- æœ¬åœ°æ¨¡å‹ï¼ˆOllama, LM Studioï¼‰

---

#### 2.2 è¿æ¥æ± ç®¡ç†

**éœ€æ±‚æ¥æº**: ç°æœ‰aiæ¨¡å—çš„LLMClientPool

**åŠŸèƒ½ç‚¹**:
- [ ] æœ€å°/æœ€å¤§è¿æ¥æ•°æ§åˆ¶
- [ ] è¿æ¥å¥åº·æ£€æŸ¥
- [ ] è‡ªåŠ¨å›æ”¶ç©ºé—²è¿æ¥
- [ ] è¿æ¥å¤ç”¨å’Œé‡Šæ”¾
- [ ] åå°æ¸…ç†ä»»åŠ¡
- [ ] ç»Ÿè®¡ä¿¡æ¯æ”¶é›†

**æ€§èƒ½æŒ‡æ ‡**:
- è¿æ¥å¤ç”¨ç‡ â‰¥ 95%
- è¿æ¥è·å–æ—¶é—´ < 10ms
- ç©ºé—²è¿æ¥æ¸…ç†å‘¨æœŸ: 5åˆ†é’Ÿ

**ä½¿ç”¨æ–¹å¼**:
```python
async with llm_pool.acquire(model) as client:
    response = await client.chat(prompt)
# è‡ªåŠ¨é‡Šæ”¾è¿æ¥
```

---

#### 2.3 Skillç³»ç»Ÿï¼ˆæ’å…¥æ¨¡å¼ï¼‰

**éœ€æ±‚æ¥æº**: ç°æœ‰aiæ¨¡å— + daoyouCodePilot

**åŠŸèƒ½ç‚¹**:
- [ ] YAML + Markdowné…ç½®é©±åŠ¨
- [ ] SkillåŠ è½½å’Œæ³¨å†Œ
- [ ] Skillæ‰§è¡Œå™¨ï¼ˆå®Œæ•´æ¨¡å¼ + è¿½é—®æ¨¡å¼ï¼‰
- [ ] Promptæ¨¡æ¿æ¸²æŸ“ï¼ˆJinja2ï¼‰
- [ ] è¾“å…¥éªŒè¯å’Œè¾“å‡ºè§£æ
- [ ] åå¤„ç†ç®¡é“

**Skillç›®å½•ç»“æ„**:
```
skills/
â”œâ”€â”€ symptom_recorder/
â”‚   â”œâ”€â”€ skill.yaml      # é…ç½®
â”‚   â””â”€â”€ prompt.md       # Promptæ¨¡æ¿
â”œâ”€â”€ knowledge_base/
â”‚   â”œâ”€â”€ skill.yaml
â”‚   â””â”€â”€ prompt.md
â””â”€â”€ appointment_helper/
    â”œâ”€â”€ skill.yaml
    â””â”€â”€ prompt.md
```

**Skillé…ç½®ç¤ºä¾‹**:
```yaml
name: symptom_recorder
version: 1.0.0
description: ç—‡çŠ¶è®°å½•åŠ©æ‰‹
inputs:
  - name: user_message
    type: string
    required: true
outputs:
  - name: response
    type: string
llm:
  model: qwen-coder-plus
  temperature: 0.7
  max_tokens: 1000
post_process:
  - validate_output
  - save_to_database
```

---

#### 2.4 ä¸Šä¸‹æ–‡ç®¡ç†ï¼ˆè®°å¿†åŠŸèƒ½ï¼‰

**éœ€æ±‚æ¥æº**: ç°æœ‰aiæ¨¡å—çš„ContextManager

**åŠŸèƒ½ç‚¹**:
- [ ] çŸ­æœŸè®°å¿†ï¼ˆä¼šè¯çº§ï¼‰
- [ ] é•¿æœŸè®°å¿†ï¼ˆç”¨æˆ·çº§ï¼‰
- [ ] ä¸Šä¸‹æ–‡å‹ç¼©å’Œæ‘˜è¦
- [ ] æ™ºèƒ½è¿½é—®åˆ¤æ–­ï¼ˆä¸‰å±‚ç€‘å¸ƒå¼ï¼‰
- [ ] å¯¹è¯æ ‘ç»“æ„
- [ ] ä¸Šä¸‹æ–‡æ£€ç´¢

**ä¸‰å±‚è¿½é—®åˆ¤æ–­**:
```
ç¬¬1å±‚ï¼šå¿«é€Ÿè§„åˆ™ï¼ˆ0.5msï¼‰- 90%è¦†ç›–
â”œâ”€ æ–°è¯é¢˜æ ‡å¿—ï¼š"ç®—äº†"ã€"æ¢ä¸ª"
â”œâ”€ æŒ‡ä»£è¯ï¼š"å®ƒ"ã€"è¿™ä¸ª"
â””â”€ ç®€çŸ­å›ç­”ï¼šæ§½ä½å¡«å……

ç¬¬2å±‚ï¼šæ„å›¾æ ‘ï¼ˆ1msï¼‰- 8%è¦†ç›–
â”œâ”€ ç»“æ„åŒ–å¯¹è¯å…³ç³»
â”œâ”€ å…³é”®è¯ç´¢å¼•
â””â”€ O(log n)æŸ¥æ‰¾

ç¬¬3å±‚ï¼šBM25ï¼ˆ5msï¼‰- 2%è¦†ç›–
â”œâ”€ å…³é”®è¯é‡å 
â”œâ”€ è¯é¢˜ç›¸å…³æ€§
â””â”€ ä¿¡æ¯æ£€ç´¢ç®—æ³•
```

**æ€§èƒ½æŒ‡æ ‡**:
- è¿½é—®åˆ¤æ–­å‡†ç¡®ç‡ â‰¥ 92%
- å¹³å‡åˆ¤æ–­æ—¶é—´ < 3ms
- TokenèŠ‚çœç‡ â‰¥ 44%

---

#### 2.5 æ™ºèƒ½ä½“ç¼–æ’ç³»ç»Ÿ

**éœ€æ±‚æ¥æº**: oh-my-opencode

**åŠŸèƒ½ç‚¹**:
- [ ] 13ä¸ªä¸“ä¸šæ™ºèƒ½ä½“ï¼ˆSisyphus, ChineseEditor, Oracleç­‰ï¼‰
- [ ] æ™ºèƒ½ä½“åä½œå’Œä»»åŠ¡å§”æ‰˜
- [ ] å¹¶è¡Œæ‰§è¡Œå’Œåå°ä»»åŠ¡
- [ ] æ™ºèƒ½ä½“æƒé™æ§åˆ¶
- [ ] ä»»åŠ¡è·¯ç”±å’Œåˆ†å‘

**æ™ºèƒ½ä½“åˆ—è¡¨**:
| æ™ºèƒ½ä½“ | æ¨¡å‹ | èŒè´£ | ä¼˜å…ˆçº§ |
|--------|------|------|--------|
| **Sisyphus** | Claude Opus 4.5 | ä¸»ç¼–æ’å™¨ï¼Œä»»åŠ¡åˆ†è§£ | â­â­â­â­â­ |
| **ChineseEditor** | Qwen Coder Plus | ä¸­æ–‡ä»£ç ç¼–è¾‘ä¸“å®¶ | â­â­â­â­â­ |
| **Oracle** | GPT 5.2 | æ¶æ„é¡¾é—®ï¼Œé«˜IQåˆ†æ | â­â­â­â­â­ |
| **Librarian** | GLM 4.7 | æ–‡æ¡£æŸ¥æ‰¾ï¼Œä»£ç æœç´¢ | â­â­â­â­â­ |
| **Explore** | Grok Code | å¿«é€Ÿä»£ç æ¢ç´¢ | â­â­â­â­ |
| **RefactorMaster** | Claude Opus 4.5 | ä»£ç é‡æ„ä¸“å®¶ | â­â­â­â­ |
| **TestExpert** | DeepSeek Coder | æµ‹è¯•ç¼–å†™å’Œä¿®å¤ | â­â­â­â­ |
| **FrontendExpert** | Gemini 3 Pro | å‰ç«¯UI/UX | â­â­â­ |
| **BackendExpert** | Qwen Max | åç«¯é€»è¾‘ | â­â­â­ |
| **Prometheus** | Claude Opus 4.5 | æˆ˜ç•¥è§„åˆ’å¸ˆ | â­â­â­ |
| **Metis** | Claude Sonnet 4.5 | è®¡åˆ’é¡¾é—® | â­â­ |
| **Momus** | Claude Sonnet 4.5 | è®¡åˆ’å®¡æŸ¥ | â­â­ |
| **Multimodal** | Gemini 3 Flash | å›¾åƒ/PDFåˆ†æ | â­â­ |

---

#### 2.6 Hookç³»ç»Ÿ

**éœ€æ±‚æ¥æº**: oh-my-opencode

**åŠŸèƒ½ç‚¹**:
- [ ] äº‹ä»¶é©±åŠ¨çš„Hookæœºåˆ¶
- [ ] 25+ å†…ç½®Hooks
- [ ] è‡ªå®šä¹‰Hookæ”¯æŒ
- [ ] Hookä¼˜å…ˆçº§å’Œæ‰§è¡Œé¡ºåº
- [ ] Hooké…ç½®ç®¡ç†

**Hookåˆ†ç±»**:
- **ä¸Šä¸‹æ–‡æ³¨å…¥**: directory-agents-injector, directory-readme-injector
- **ç”Ÿäº§åŠ›æ§åˆ¶**: keyword-detector, think-mode, ralph-loop
- **è´¨é‡å®‰å…¨**: comment-checker, thinking-block-validator
- **æ¢å¤ç¨³å®š**: session-recovery, context-window-limit-recovery
- **é€šçŸ¥UX**: auto-update-checker, background-notification

---

#### 2.7 æ™ºèƒ½æ¨¡å‹é€‰æ‹©

**éœ€æ±‚æ¥æº**: daoyouCodePilot + oh-my-opencode

**åŠŸèƒ½ç‚¹**:
- [ ] åŸºäºä»»åŠ¡ç±»å‹çš„æ¨¡å‹é€‰æ‹©
- [ ] åŸºäºè¯­è¨€çš„æ¨¡å‹é€‰æ‹©ï¼ˆä¸­æ–‡ä¼˜å…ˆï¼‰
- [ ] åŸºäºå¤æ‚åº¦çš„æ¨¡å‹é€‰æ‹©
- [ ] æˆæœ¬ä¼˜åŒ–ç­–ç•¥
- [ ] æ¨¡å‹é™çº§å’Œå›é€€

**é€‰æ‹©ç­–ç•¥**:
```python
if task.language == "zh-CN" and task.complexity == "simple":
    model = "qwen-coder-plus"  # ä¾¿å®œå¿«é€Ÿ
elif task.type == "architecture":
    model = "gpt-5.2"  # é«˜IQ
elif task.type == "refactor":
    model = "claude-opus-4-5"  # é‡æ„ä¸“å®¶
elif task.type == "frontend":
    model = "gemini-3-pro"  # å‰ç«¯ä¸“å®¶
else:
    model = "qwen-max"  # é»˜è®¤
```

---

### 3. éåŠŸèƒ½éœ€æ±‚

#### 3.1 æ€§èƒ½è¦æ±‚
- [ ] LLMå“åº”æ—¶é—´ < 3ç§’ï¼ˆéæµå¼ï¼‰
- [ ] æµå¼å“åº”é¦–å­—èŠ‚æ—¶é—´ < 500ms
- [ ] å¹¶å‘æ”¯æŒ â‰¥ 100 QPS
- [ ] è¿æ¥æ± å¤ç”¨ç‡ â‰¥ 95%

#### 3.2 å¯é æ€§è¦æ±‚
- [ ] è‡ªåŠ¨é‡è¯•æœºåˆ¶ï¼ˆæœ€å¤š3æ¬¡ï¼‰
- [ ] é”™è¯¯æ¢å¤å’Œé™çº§
- [ ] è¯·æ±‚è¶…æ—¶æ§åˆ¶
- [ ] ç†”æ–­å™¨æ¨¡å¼

#### 3.3 å¯è§‚æµ‹æ€§è¦æ±‚
- [ ] å®Œæ•´çš„è¯·æ±‚/å“åº”æ—¥å¿—
- [ ] Tokenä½¿ç”¨ç»Ÿè®¡
- [ ] æˆæœ¬è¿½è¸ªå’ŒæŠ¥å‘Š
- [ ] æ€§èƒ½ç›‘æ§æŒ‡æ ‡
- [ ] é”™è¯¯ç‡ç›‘æ§

#### 3.4 å®‰å…¨æ€§è¦æ±‚
- [ ] API Keyå®‰å…¨å­˜å‚¨
- [ ] è¯·æ±‚ç­¾åéªŒè¯
- [ ] æ•æ„Ÿä¿¡æ¯è„±æ•
- [ ] è®¿é—®æ§åˆ¶å’Œæƒé™ç®¡ç†

---

## ğŸ“ æ¶æ„è®¾è®¡

### æ•´ä½“æ¶æ„

```
ç”¨æˆ·è¯·æ±‚
    â†“
AIç¼–æ’å™¨ (Orchestrator)
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ™ºèƒ½ä½“å±‚ (Agents)                   â”‚
â”‚  â”œâ”€ Sisyphus (ä¸»ç¼–æ’)                â”‚
â”‚  â”œâ”€ ChineseEditor (ä¸­æ–‡ç¼–è¾‘)         â”‚
â”‚  â”œâ”€ Oracle (æ¶æ„é¡¾é—®)                â”‚
â”‚  â””â”€ ... (å…¶ä»–æ™ºèƒ½ä½“)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Skillç³»ç»Ÿ (Skills)                  â”‚
â”‚  â”œâ”€ SkillåŠ è½½å™¨                      â”‚
â”‚  â”œâ”€ Skillæ‰§è¡Œå™¨                      â”‚
â”‚  â””â”€ Promptæ¨¡æ¿å¼•æ“                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä¸Šä¸‹æ–‡ç®¡ç† (Context)                â”‚
â”‚  â”œâ”€ çŸ­æœŸè®°å¿†                         â”‚
â”‚  â”œâ”€ é•¿æœŸè®°å¿†                         â”‚
â”‚  â”œâ”€ è¿½é—®åˆ¤æ–­                         â”‚
â”‚  â””â”€ å¯¹è¯æ ‘                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  LLMå®¢æˆ·ç«¯æ±  (Pool)                  â”‚
â”‚  â”œâ”€ è¿æ¥ç®¡ç†                         â”‚
â”‚  â”œâ”€ å¥åº·æ£€æŸ¥                         â”‚
â”‚  â””â”€ ç»Ÿè®¡æ”¶é›†                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  LLMå®¢æˆ·ç«¯ (Clients)                 â”‚
â”‚  â”œâ”€ é€šä¹‰åƒé—®                         â”‚
â”‚  â”œâ”€ DeepSeek                         â”‚
â”‚  â”œâ”€ Claude                           â”‚
â”‚  â”œâ”€ GPT                              â”‚
â”‚  â””â”€ æœ¬åœ°æ¨¡å‹                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
å¤–éƒ¨LLMæœåŠ¡
```

---

### ç›®å½•ç»“æ„

```
backend/daoyoucode/llm/
â”œâ”€â”€ __init__.py
â”‚
â”œâ”€â”€ base.py                    # åŸºç¡€æ¥å£å®šä¹‰
â”œâ”€â”€ orchestrator.py            # AIç¼–æ’å™¨ï¼ˆä¸»å…¥å£ï¼‰
â”œâ”€â”€ router.py                  # ä»»åŠ¡è·¯ç”±å™¨
â”œâ”€â”€ model_selector.py          # æ™ºèƒ½æ¨¡å‹é€‰æ‹©
â”‚
â”œâ”€â”€ clients/                   # LLMå®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ base.py               # åŸºç¡€å®¢æˆ·ç«¯æ¥å£
â”‚   â”œâ”€â”€ unified.py            # ç»Ÿä¸€å®¢æˆ·ç«¯ï¼ˆOpenAIå…¼å®¹ï¼‰
â”‚   â”œâ”€â”€ qwen.py               # é€šä¹‰åƒé—®
â”‚   â”œâ”€â”€ deepseek.py           # DeepSeek
â”‚   â”œâ”€â”€ claude.py             # Claude
â”‚   â”œâ”€â”€ openai.py             # OpenAI
â”‚   â”œâ”€â”€ gemini.py             # Gemini
â”‚   â””â”€â”€ local.py              # æœ¬åœ°æ¨¡å‹ï¼ˆOllamaï¼‰
â”‚
â”œâ”€â”€ pool/                      # è¿æ¥æ± ç®¡ç†
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ client_pool.py        # LLMå®¢æˆ·ç«¯æ± 
â”‚   â”œâ”€â”€ health_checker.py     # å¥åº·æ£€æŸ¥
â”‚   â””â”€â”€ stats_collector.py    # ç»Ÿè®¡æ”¶é›†
â”‚
â”œâ”€â”€ agents/                    # æ™ºèƒ½ä½“ç³»ç»Ÿ
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ base.py               # åŸºç¡€æ™ºèƒ½ä½“
â”‚   â”œâ”€â”€ sisyphus.py           # ä¸»ç¼–æ’å™¨
â”‚   â”œâ”€â”€ chinese_editor.py     # ä¸­æ–‡ç¼–è¾‘
â”‚   â”œâ”€â”€ oracle.py             # æ¶æ„é¡¾é—®
â”‚   â”œâ”€â”€ librarian.py          # æ–‡æ¡£ä¸“å®¶
â”‚   â”œâ”€â”€ explore.py            # ä»£ç æ¢ç´¢
â”‚   â”œâ”€â”€ refactor.py           # é‡æ„ä¸“å®¶
â”‚   â”œâ”€â”€ test_expert.py        # æµ‹è¯•ä¸“å®¶
â”‚   â”œâ”€â”€ frontend.py           # å‰ç«¯ä¸“å®¶
â”‚   â”œâ”€â”€ backend.py            # åç«¯ä¸“å®¶
â”‚   â”œâ”€â”€ prometheus.py         # æˆ˜ç•¥è§„åˆ’
â”‚   â”œâ”€â”€ metis.py              # è®¡åˆ’é¡¾é—®
â”‚   â”œâ”€â”€ momus.py              # è®¡åˆ’å®¡æŸ¥
â”‚   â””â”€â”€ multimodal.py         # å¤šæ¨¡æ€åˆ†æ
â”‚
â”œâ”€â”€ skills/                    # Skillç³»ç»Ÿ
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ loader.py             # SkillåŠ è½½å™¨
â”‚   â”œâ”€â”€ executor.py           # Skillæ‰§è¡Œå™¨
â”‚   â”œâ”€â”€ registry.py           # Skillæ³¨å†Œè¡¨
â”‚   â””â”€â”€ template_engine.py    # æ¨¡æ¿å¼•æ“
â”‚
â”œâ”€â”€ context/                   # ä¸Šä¸‹æ–‡ç®¡ç†
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ manager.py            # ä¸Šä¸‹æ–‡ç®¡ç†å™¨
â”‚   â”œâ”€â”€ short_term.py         # çŸ­æœŸè®°å¿†
â”‚   â”œâ”€â”€ long_term.py          # é•¿æœŸè®°å¿†
â”‚   â”œâ”€â”€ followup_detector.py  # è¿½é—®åˆ¤æ–­
â”‚   â”œâ”€â”€ intent_tree.py        # æ„å›¾æ ‘
â”‚   â”œâ”€â”€ bm25_matcher.py       # BM25åŒ¹é…
â”‚   â””â”€â”€ compressor.py         # ä¸Šä¸‹æ–‡å‹ç¼©
â”‚
â”œâ”€â”€ hooks/                     # Hookç³»ç»Ÿ
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ manager.py            # Hookç®¡ç†å™¨
â”‚   â”œâ”€â”€ base.py               # åŸºç¡€Hook
â”‚   â””â”€â”€ builtin/              # å†…ç½®Hooks
â”‚       â”œâ”€â”€ context_injector.py
â”‚       â”œâ”€â”€ keyword_detector.py
â”‚       â”œâ”€â”€ think_mode.py
â”‚       â””â”€â”€ ...
â”‚
â””â”€â”€ utils/                     # å·¥å…·å‡½æ•°
    â”œâ”€â”€ __init__.py
    â”œâ”€â”€ token_counter.py      # Tokenè®¡æ•°
    â”œâ”€â”€ cost_calculator.py    # æˆæœ¬è®¡ç®—
    â”œâ”€â”€ logger.py             # æ—¥å¿—å·¥å…·
    â””â”€â”€ retry.py              # é‡è¯•æœºåˆ¶
```

---

## ğŸ”„ æ•°æ®æµè®¾è®¡

### 1. æ™®é€šå¯¹è¯æµç¨‹

```
ç”¨æˆ·è¾“å…¥
    â†“
Orchestrator.chat()
    â†“
ContextManager.get_context()  # åŠ è½½å†å²
    â†“
æ„å»ºPrompt
    â†“
LLMPool.acquire(model)  # è·å–è¿æ¥
    â†“
LLMClient.chat(prompt)  # è°ƒç”¨LLM
    â†“
LLMPool.release()  # é‡Šæ”¾è¿æ¥
    â†“
ContextManager.update_context()  # æ›´æ–°å†å²
    â†“
è¿”å›å“åº”
```

### 2. Skillæ‰§è¡Œæµç¨‹

```
ç”¨æˆ·è¾“å…¥ + Skillåç§°
    â†“
Orchestrator.execute_skill()
    â†“
SkillLoader.get_skill()  # è·å–Skillé…ç½®
    â†“
ContextManager.is_followup_question()  # åˆ¤æ–­æ˜¯å¦è¿½é—®
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ˜¯è¿½é—®      â”‚  é¦–æ¬¡è°ƒç”¨    â”‚
â”‚  â†“          â”‚  â†“          â”‚
â”‚  è½»é‡çº§Promptâ”‚  å®Œæ•´Prompt  â”‚
â”‚  (300 tokens)â”‚ (1000 tokens)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
SkillExecutor.execute()  # æ‰§è¡ŒSkill
    â†“
TemplateEngine.render()  # æ¸²æŸ“Prompt
    â†“
LLMPool.acquire(model)  # è·å–è¿æ¥
    â†“
LLMClient.chat(prompt)  # è°ƒç”¨LLM
    â†“
LLMPool.release()  # é‡Šæ”¾è¿æ¥
    â†“
åå¤„ç†ï¼ˆéªŒè¯ã€ä¿å­˜ç­‰ï¼‰
    â†“
ContextManager.update_context()  # æ›´æ–°å†å²
    â†“
è¿”å›å“åº”
```

### 3. æ™ºèƒ½ä½“åä½œæµç¨‹

```
å¤æ‚ä»»åŠ¡
    â†“
Sisyphus (ä¸»ç¼–æ’å™¨)
    â†“
ä»»åŠ¡åˆ†è§£
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Explore  â”‚ Oracle   â”‚ Refactor â”‚
â”‚ ä»£ç æ¢ç´¢  â”‚ æ¶æ„åˆ†æ  â”‚ ä»£ç é‡æ„  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“          â†“          â†“
å¹¶è¡Œæ‰§è¡Œï¼ˆåå°ä»»åŠ¡ï¼‰
    â†“
ç»“æœèšåˆ
    â†“
Sisyphus æ•´åˆç»“æœ
    â†“
è¿”å›æœ€ç»ˆå“åº”
```

---

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

### 1. Tokenä¼˜åŒ–

**ç­–ç•¥**:
- æ™ºèƒ½è¿½é—®åˆ¤æ–­ï¼ˆèŠ‚çœ44% tokensï¼‰
- ä¸Šä¸‹æ–‡å‹ç¼©å’Œæˆªæ–­
- åŠ¨æ€æ‘˜è¦ç”Ÿæˆ
- å…³é”®ä¿¡æ¯æå–

**æ•ˆæœ**:
- é¦–æ¬¡è°ƒç”¨: 1000 tokens
- è¿½é—®: 300 tokens
- èŠ‚çœ: 700 tokens (70%)

### 2. è¿æ¥å¤ç”¨

**ç­–ç•¥**:
- è¿æ¥æ± ç®¡ç†
- æœ€å°/æœ€å¤§è¿æ¥æ•°æ§åˆ¶
- ç©ºé—²è¿æ¥å›æ”¶
- å¥åº·æ£€æŸ¥

**æ•ˆæœ**:
- è¿æ¥å¤ç”¨ç‡: 95%
- è¿æ¥è·å–æ—¶é—´: < 10ms
- èŠ‚çœè¿æ¥å»ºç«‹æ—¶é—´: 9%

### 3. å¹¶å‘æ§åˆ¶

**ç­–ç•¥**:
- æ™ºèƒ½ä½“å¹¶è¡Œæ‰§è¡Œ
- åå°ä»»åŠ¡å¼‚æ­¥å¤„ç†
- æŒ‰æä¾›å•†/æ¨¡å‹é™æµ
- ç†”æ–­å™¨ä¿æŠ¤

**æ•ˆæœ**:
- æ”¯æŒå¹¶å‘: 100+ QPS
- ä»»åŠ¡æ‰§è¡Œæ—¶é—´: å‡å°‘50%

---

## ğŸ’° æˆæœ¬æ§åˆ¶ç­–ç•¥

### 1. æ™ºèƒ½æ¨¡å‹é€‰æ‹©

**ç­–ç•¥**:
- ç®€å•ä»»åŠ¡ç”¨ä¾¿å®œæ¨¡å‹ï¼ˆqwen-turboï¼‰
- å¤æ‚ä»»åŠ¡ç”¨å¼ºå¤§æ¨¡å‹ï¼ˆgpt-5.2ï¼‰
- ä¸­æ–‡ä»»åŠ¡ä¼˜å…ˆå›½äº§æ¨¡å‹
- è‡ªåŠ¨é™çº§å’Œå›é€€

**æ•ˆæœ**:
- å¹³å‡æˆæœ¬é™ä½: 40%
- å‡†ç¡®ç‡ä¿æŒ: 95%+

### 2. Tokené¢„ç®—æ§åˆ¶

**ç­–ç•¥**:
- æ¯ä¸ªç”¨æˆ·/ä¼šè¯çš„Tokené¢„ç®—
- è¶…é¢„ç®—è‡ªåŠ¨é™çº§
- æˆæœ¬æŠ¥å‘Šå’Œå‘Šè­¦
- ä½¿ç”¨ç»Ÿè®¡åˆ†æ

**æ•ˆæœ**:
- æˆæœ¬å¯æ§
- é¿å…è¶…æ”¯

---

## ğŸ§ª æµ‹è¯•ç­–ç•¥

### 1. å•å…ƒæµ‹è¯•

**è¦†ç›–èŒƒå›´**:
- [ ] LLMå®¢æˆ·ç«¯ï¼ˆå„æä¾›å•†ï¼‰
- [ ] è¿æ¥æ± ç®¡ç†
- [ ] SkillåŠ è½½å’Œæ‰§è¡Œ
- [ ] ä¸Šä¸‹æ–‡ç®¡ç†
- [ ] è¿½é—®åˆ¤æ–­ç®—æ³•
- [ ] Hookç³»ç»Ÿ

**ç›®æ ‡è¦†ç›–ç‡**: â‰¥ 80%

### 2. é›†æˆæµ‹è¯•

**æµ‹è¯•åœºæ™¯**:
- [ ] ç«¯åˆ°ç«¯å¯¹è¯æµç¨‹
- [ ] Skillæ‰§è¡Œæµç¨‹
- [ ] æ™ºèƒ½ä½“åä½œ
- [ ] å¹¶å‘å‹åŠ›æµ‹è¯•
- [ ] é”™è¯¯æ¢å¤æµ‹è¯•

### 3. æ€§èƒ½æµ‹è¯•

**æµ‹è¯•æŒ‡æ ‡**:
- [ ] å“åº”æ—¶é—´
- [ ] ååé‡ï¼ˆQPSï¼‰
- [ ] è¿æ¥æ± æ€§èƒ½
- [ ] Tokenä½¿ç”¨æ•ˆç‡
- [ ] æˆæœ¬ç»Ÿè®¡

---

## ğŸ“… å®æ–½è®¡åˆ’

### é˜¶æ®µ1: åŸºç¡€æ¶æ„ï¼ˆ2å‘¨ï¼‰

**ä»»åŠ¡**:
- [ ] åˆ›å»ºç›®å½•ç»“æ„
- [ ] å®ç°åŸºç¡€æ¥å£å®šä¹‰
- [ ] å®ç°ç»Ÿä¸€LLMå®¢æˆ·ç«¯ï¼ˆOpenAIå…¼å®¹ï¼‰
- [ ] å®ç°è¿æ¥æ± ç®¡ç†
- [ ] å•å…ƒæµ‹è¯•

**äº¤ä»˜ç‰©**:
- `backend/daoyoucode/llm/base.py`
- `backend/daoyoucode/llm/clients/`
- `backend/daoyoucode/llm/pool/`
- æµ‹è¯•ç”¨ä¾‹

### é˜¶æ®µ2: Skillç³»ç»Ÿï¼ˆ1å‘¨ï¼‰

**ä»»åŠ¡**:
- [ ] å®ç°SkillåŠ è½½å™¨
- [ ] å®ç°Skillæ‰§è¡Œå™¨
- [ ] å®ç°æ¨¡æ¿å¼•æ“
- [ ] åˆ›å»ºç¤ºä¾‹Skills
- [ ] å•å…ƒæµ‹è¯•

**äº¤ä»˜ç‰©**:
- `backend/daoyoucode/llm/skills/`
- `skills/` ç›®å½•å’Œç¤ºä¾‹
- æµ‹è¯•ç”¨ä¾‹

### é˜¶æ®µ3: ä¸Šä¸‹æ–‡ç®¡ç†ï¼ˆ1å‘¨ï¼‰

**ä»»åŠ¡**:
- [ ] å®ç°ä¸Šä¸‹æ–‡ç®¡ç†å™¨
- [ ] å®ç°è¿½é—®åˆ¤æ–­ï¼ˆä¸‰å±‚ç€‘å¸ƒå¼ï¼‰
- [ ] å®ç°çŸ­æœŸ/é•¿æœŸè®°å¿†
- [ ] å®ç°å¯¹è¯æ ‘
- [ ] å•å…ƒæµ‹è¯•

**äº¤ä»˜ç‰©**:
- `backend/daoyoucode/llm/context/`
- æµ‹è¯•ç”¨ä¾‹

### é˜¶æ®µ4: æ™ºèƒ½ä½“ç³»ç»Ÿï¼ˆ1-2å‘¨ï¼‰

**ä»»åŠ¡**:
- [ ] å®ç°åŸºç¡€æ™ºèƒ½ä½“æ¡†æ¶
- [ ] å®ç°5ä¸ªæ ¸å¿ƒæ™ºèƒ½ä½“ï¼ˆSisyphus, ChineseEditor, Oracle, Librarian, Exploreï¼‰
- [ ] å®ç°æ™ºèƒ½ä½“åä½œæœºåˆ¶
- [ ] å®ç°ä»»åŠ¡è·¯ç”±å™¨
- [ ] é›†æˆæµ‹è¯•

**äº¤ä»˜ç‰©**:
- `backend/daoyoucode/llm/agents/`
- `backend/daoyoucode/llm/router.py`
- æµ‹è¯•ç”¨ä¾‹

### é˜¶æ®µ5: Hookç³»ç»Ÿï¼ˆ1å‘¨ï¼‰

**ä»»åŠ¡**:
- [ ] å®ç°Hookç®¡ç†å™¨
- [ ] å®ç°10ä¸ªæ ¸å¿ƒHooks
- [ ] Hooké…ç½®ç®¡ç†
- [ ] å•å…ƒæµ‹è¯•

**äº¤ä»˜ç‰©**:
- `backend/daoyoucode/llm/hooks/`
- æµ‹è¯•ç”¨ä¾‹

### é˜¶æ®µ6: é›†æˆå’Œä¼˜åŒ–ï¼ˆ1å‘¨ï¼‰

**ä»»åŠ¡**:
- [ ] ç«¯åˆ°ç«¯é›†æˆæµ‹è¯•
- [ ] æ€§èƒ½ä¼˜åŒ–
- [ ] æˆæœ¬ä¼˜åŒ–
- [ ] æ–‡æ¡£å®Œå–„
- [ ] éƒ¨ç½²å‡†å¤‡

**äº¤ä»˜ç‰©**:
- å®Œæ•´çš„LLMæ¨¡å—
- æ€§èƒ½æµ‹è¯•æŠ¥å‘Š
- æˆæœ¬åˆ†ææŠ¥å‘Š
- ä½¿ç”¨æ–‡æ¡£

---

## ğŸ“š å‚è€ƒèµ„æ–™

### ç°æœ‰aiæ¨¡å—
- `ai/orchestrator.py` - AIç¼–æ’å™¨
- `ai/llm_client_pool.py` - è¿æ¥æ± ç®¡ç†
- `ai/skill_loader.py` - SkillåŠ è½½
- `ai/unified_matcher.py` - è¿½é—®åˆ¤æ–­
- `ai/docs/01_LLM_ARCHITECTURE.md` - LLMæ¶æ„æ–‡æ¡£
- `ai/docs/02_CONTEXT_MATCHING.md` - ä¸Šä¸‹æ–‡åŒ¹é…æ–‡æ¡£

### daoyouCodePilot
- `daoyouCodePilot/daoyou/core/llm/` - LLMå®ç°
- `daoyouCodePilot/daoyou/skills/` - Skillç³»ç»Ÿ
- `daoyouCodePilot/docs/SKILL_SYSTEM_SPEC.md` - Skillè§„èŒƒ

### oh-my-opencode
- `oh-my-opencode/src/agents/` - æ™ºèƒ½ä½“å®ç°
- `oh-my-opencode/src/hooks/` - Hookç³»ç»Ÿ
- `oh-my-opencode/docs/orchestration-guide.md` - ç¼–æ’æŒ‡å—

### OpenCode
- `opencode/packages/opencode/` - æ ¸å¿ƒå®ç°
- `opencode/.opencode/agent/` - æ™ºèƒ½ä½“é…ç½®
- `opencode/AGENTS.md` - æ™ºèƒ½ä½“æ–‡æ¡£

---

## âœ… éªŒæ”¶æ ‡å‡†

### åŠŸèƒ½éªŒæ”¶
- [ ] æ”¯æŒæ‰€æœ‰åˆ—å‡ºçš„LLMæä¾›å•†
- [ ] è¿æ¥æ± æ­£å¸¸å·¥ä½œï¼Œå¤ç”¨ç‡ â‰¥ 95%
- [ ] Skillç³»ç»Ÿå¯é…ç½®åŒ–ï¼Œæ˜“äºæ‰©å±•
- [ ] è¿½é—®åˆ¤æ–­å‡†ç¡®ç‡ â‰¥ 92%
- [ ] æ™ºèƒ½ä½“åä½œæ­£å¸¸ï¼Œä»»åŠ¡æ­£ç¡®åˆ†å‘
- [ ] Hookç³»ç»Ÿå·¥ä½œæ­£å¸¸

### æ€§èƒ½éªŒæ”¶
- [ ] LLMå“åº”æ—¶é—´ < 3ç§’
- [ ] æµå¼å“åº”é¦–å­—èŠ‚ < 500ms
- [ ] å¹¶å‘æ”¯æŒ â‰¥ 100 QPS
- [ ] TokenèŠ‚çœç‡ â‰¥ 44%

### è´¨é‡éªŒæ”¶
- [ ] å•å…ƒæµ‹è¯•è¦†ç›–ç‡ â‰¥ 80%
- [ ] é›†æˆæµ‹è¯•é€šè¿‡
- [ ] æ€§èƒ½æµ‹è¯•é€šè¿‡
- [ ] ä»£ç å®¡æŸ¥é€šè¿‡
- [ ] æ–‡æ¡£å®Œæ•´

---

## ğŸš€ åç»­æ‰©å±•

### Phase 2: Tool & MCPé›†æˆï¼ˆ3-4å‘¨ï¼‰
- MCPåè®®é›†æˆ
- å·¥å…·æ³¨å†Œä¸å‘ç°
- å·¥å…·é“¾ç¼–æ’

### Phase 3: Memoryç³»ç»Ÿï¼ˆ3-4å‘¨ï¼‰
- çŸ¥è¯†å›¾è°±
- è®°å¿†æ£€ç´¢ä¸æ›´æ–°
- è·¨ä¼šè¯ä¿¡æ¯å…³è”

### Phase 4: Knowledge Baseï¼ˆ3-4å‘¨ï¼‰
- RAGæ£€ç´¢å¢å¼ºç”Ÿæˆ
- å‘é‡åŒ–ä¸ç´¢å¼•
- æ··åˆæ£€ç´¢

### Phase 5: æ¨ç†ä¸è§„åˆ’ï¼ˆ3-4å‘¨ï¼‰
- ReActæ¨¡å¼
- Chain-of-Thought
- å¤šæ­¥éª¤è§„åˆ’

---

**è§„èŒƒç‰ˆæœ¬**: v1.0  
**åˆ›å»ºæ—¥æœŸ**: 2026-02-10  
**æœ€åæ›´æ–°**: 2026-02-10  
**è´Ÿè´£äºº**: AI Team
