# âœ… å·¥å…·ç³»ç»Ÿå·²å°±ç»ª

## ä¿®å¤å†…å®¹

### é—®é¢˜
Agentå°è¯•è°ƒç”¨ `repo_map` å·¥å…·æ—¶æŠ¥é”™ï¼š"Tool not found: repo_map"

### åŸå› 
å·¥å…·æ³¨å†Œè¡¨æ²¡æœ‰åœ¨ç³»ç»Ÿå¯åŠ¨æ—¶åˆå§‹åŒ–

### è§£å†³æ–¹æ¡ˆ
åœ¨ `backend/daoyoucode/agents/__init__.py` ä¸­æ·»åŠ ï¼š

```python
# åˆå§‹åŒ–å·¥å…·æ³¨å†Œè¡¨ï¼ˆç¡®ä¿å·¥å…·åœ¨ç³»ç»Ÿå¯åŠ¨æ—¶å°±å¯ç”¨ï¼‰
from .tools import get_tool_registry
_tool_registry = get_tool_registry()  # è§¦å‘å·¥å…·æ³¨å†Œ
```

## éªŒè¯

### å·¥å…·æ³¨å†Œæµ‹è¯•
```bash
python backend/test_tool_registry.py
```

ç»“æœï¼š
```
âœ“ å·²æ³¨å†Œ 25 ä¸ªå·¥å…·:
  â€¢ repo_map âœ“
  â€¢ get_repo_structure âœ“
  â€¢ read_file âœ“
  â€¢ write_file âœ“
  â€¢ list_files âœ“
  â€¢ text_search âœ“
  â€¢ regex_search âœ“
  â€¢ git_status âœ“
  â€¢ git_diff âœ“
  â€¢ git_commit âœ“
  â€¢ git_log âœ“
  â€¢ run_command âœ“
  â€¢ run_test âœ“
  â€¢ search_replace âœ“
  â€¢ lsp_diagnostics âœ“
  â€¢ lsp_goto_definition âœ“
  â€¢ lsp_find_references âœ“
  â€¢ lsp_symbols âœ“
  â€¢ lsp_rename âœ“
  â€¢ lsp_code_actions âœ“
  â€¢ ast_grep_search âœ“
  â€¢ ast_grep_replace âœ“
  â€¢ get_file_info âœ“
  â€¢ create_directory âœ“
  â€¢ delete_file âœ“
```

### å®Œæ•´æµç¨‹æµ‹è¯•
```bash
python backend/test_chat_flow.py
```

ç»“æœï¼š
```
âœ“ å·²é…ç½® 1 ä¸ªæä¾›å•†
âœ“ å·²æ³¨å†Œ 7 ä¸ªAgent
âœ“ æ‰§è¡Œå®Œæˆ
  â€¢ æˆåŠŸ: True
  â€¢ å†…å®¹: ä½ å¥½ï¼æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®ä½ çš„å—ï¼Ÿ...
```

## ç°åœ¨å¯ä»¥ä½¿ç”¨äº†

å¯åŠ¨äº¤äº’å¼å¯¹è¯ï¼š

```bash
cd backend
python -m cli.app chat
```

## æµ‹è¯•Agentå·¥å…·è°ƒç”¨

è¾“å…¥ä»¥ä¸‹é—®é¢˜ï¼ŒAgentåº”è¯¥ä¼šè‡ªåŠ¨è°ƒç”¨ç›¸åº”çš„å·¥å…·ï¼š

### 1. é¡¹ç›®ç»“æ„åˆ†æ
```
ä½  â€º è¿™ä¸ªé¡¹ç›®çš„ç»“æ„æ˜¯ä»€ä¹ˆï¼Ÿ
```
**é¢„æœŸ**: Agentè°ƒç”¨ `repo_map` å·¥å…·

### 2. æ–‡ä»¶æŸ¥çœ‹
```
ä½  â€º backend/cli/commands/chat.pyåšä»€ä¹ˆçš„ï¼Ÿ
```
**é¢„æœŸ**: Agentè°ƒç”¨ `read_file` å·¥å…·

### 3. ä»£ç æœç´¢
```
ä½  â€º execute_skillå‡½æ•°åœ¨å“ªé‡Œå®ç°çš„ï¼Ÿ
```
**é¢„æœŸ**: Agentè°ƒç”¨ `text_search` æˆ– `regex_search` å·¥å…·

### 4. å¯¹æ¯”åˆ†æ
```
ä½  â€º å¯¹æ¯”opencodeã€oh-my-opencodeï¼Œæˆ‘ä»¬DaoyouCodeçš„ä¼˜åŠ¿æ˜¯ä»€ä¹ˆï¼Ÿ
```
**é¢„æœŸ**: Agentè°ƒç”¨å¤šä¸ªå·¥å…·ï¼ˆrepo_map, read_fileç­‰ï¼‰è¿›è¡Œåˆ†æ

## å·¥å…·ç³»ç»Ÿæ¶æ„

```
ç³»ç»Ÿå¯åŠ¨
  â†“
å¯¼å…¥ daoyoucode.agents
  â†“
è‡ªåŠ¨è°ƒç”¨ get_tool_registry()
  â†“
_register_builtin_tools()
  â”œâ”€ æ³¨å†Œæ–‡ä»¶å·¥å…·ï¼ˆ6ä¸ªï¼‰
  â”œâ”€ æ³¨å†Œæœç´¢å·¥å…·ï¼ˆ2ä¸ªï¼‰
  â”œâ”€ æ³¨å†ŒGitå·¥å…·ï¼ˆ4ä¸ªï¼‰
  â”œâ”€ æ³¨å†Œå‘½ä»¤å·¥å…·ï¼ˆ2ä¸ªï¼‰
  â”œâ”€ æ³¨å†ŒDiffå·¥å…·ï¼ˆ1ä¸ªï¼‰
  â”œâ”€ æ³¨å†ŒRepoMapå·¥å…·ï¼ˆ2ä¸ªï¼‰
  â”œâ”€ æ³¨å†ŒLSPå·¥å…·ï¼ˆ6ä¸ªï¼‰
  â””â”€ æ³¨å†ŒASTå·¥å…·ï¼ˆ2ä¸ªï¼‰
  â†“
å·¥å…·æ³¨å†Œè¡¨å°±ç»ªï¼ˆ25ä¸ªå·¥å…·ï¼‰
  â†“
Agentå¯ä»¥è°ƒç”¨ä»»ä½•å·²æ³¨å†Œçš„å·¥å…·
```

## å…³é”®æ”¹è¿›

1. âœ… å·¥å…·åœ¨ç³»ç»Ÿå¯åŠ¨æ—¶è‡ªåŠ¨æ³¨å†Œ
2. âœ… ä¸éœ€è¦åœ¨chatå‘½ä»¤ä¸­æ‰‹åŠ¨åˆå§‹åŒ–
3. âœ… å•ä¾‹æ¨¡å¼ç¡®ä¿åªæ³¨å†Œä¸€æ¬¡
4. âœ… æ‰€æœ‰25ä¸ªå·¥å…·éƒ½å¯ç”¨

å¼€å§‹æµ‹è¯•å§ï¼ğŸš€
